import{u as e,s,h as t,g as o,a,b as n,c as i,d as l,e as c,n as r,f as u,r as d,i as h,w as g,j as p,o as f,k as m,l as k,t as w,m as A,p as v,q as C,v as B,x as b,y as x}from"./index-BNfv6lMe.js";import{_ as I}from"./tabbar.CTNgCPLv.js";import{r as E}from"./uni-app.es.CkiiJYsC.js";import"./index.D-NzfIhQ.js";import{_ as F}from"./JK_02_IconJF2.DsU4VPp8.js";import{_ as T}from"./_plugin-vue_export-helper.BCo6x5W8.js";const _=T({components:{tabbar:I},setup(t,o){const a=e(),{userInfo:n,measureToken:i}=s(a);return console.log("health setup:::",a),{userInfo:n,getUserInfo:a}},onLoad(e){t()},mounted(){var e=window.getCode();if(e){this.login(),window.history.pushState({page:1},null,window.location.href);let e=this;window.addEventListener("popstate",(function(s){console.log("i am from popstate",s),e.goBack()}),!1)}console.log("start123456:",e,window.history)},data:()=>({showEnouth:!1,showFirstBlood:!1,cost:60,sure:!1,measureIns:null,video:null,code:"",userInfoT:{},config:{},puposhow:!1,pupimage:[{image:"https://oss.zsyl.cc/uploads/images/20250718/202507181700036aaef5320.png"},{image:"https://oss.zsyl.cc/uploads/images/20250718/202507181700033865f6716.png"},{image:"https://oss.zsyl.cc/uploads/images/20250718/20250718170003b7b597850.png"}],pupIndex:0}),onShow(){this.sure=!!o("checkP"),this.Usercentre(),this.confgn()},methods:{confgn(){a({}).then((e=>{this.config=e,this.cost=e.detection_deduct}))},Usercentre(){n().then((e=>{console.log("res.999",e),this.userInfoT=e,1==e.is_new_user?this.puposhow=!0:this.puposhow=!1,i("nickname",e.nickname)}))},gift(){l({}).then((e=>{this.Usercentre()}))},goBack(){console.log("goback",window.WeixinJSBridge);let e=setTimeout((function(){document.addEventListener("WeixinJSBridgeReady",(function(){window.WeixinJSBridge.invoke("closeWindow")}),!1),window.WeixinJSBridge.invoke("closeWindow"),clearInterval(e)}),300)},hideFirstBlood(){this.showFirstBlood=!1,window.location.href="https://mp.weixin.qq.com/mp/profile_ext?action=home&__biz=MzkyMDQ5NTk0OQ==&scene=110#wechat_redirect"},hideEnouth(){this.showEnouth=!1},getMeasureToken(){const s=e();s.$login(),0==s.userInfo.isFollow&&(this.showFirstBlood=!0)},login(){c((e=>{this.Usercentre(),this.getMeasureToken()}))},navMoreLink(){r({url:"/pages/health/healthScoreMore"})},navMoreLinkTo(){r({url:"/pages/invite_poster/invite_poster"})},navMoreLinkToT(){r({url:"/pages/healthtest/Newconclusion?numtolt=5"})},navLink(){r({url:"/pages/health/userProtocal"})},checkPortHandler(){r({url:"/pages/health/healthResult"})},async startCamera(){this.video=document.getElementById("video"),console.log("window.navigator:",window.navigator.mediaDevices),this.video.srcObject=await window.navigator.mediaDevices.getUserMedia({video:{height:500,width:500},audio:!1}),this.video.play()},takePhoto(){document.getElementById("video");const e=document.getElementById("canvas");e.getContext("2d").drawImage(this.video,0,0,500,500);let s=e.toDataUrl("image/jpeg");return console.log(s),s},stopMedia(){this.video.srcObject.getTracks().forEach((function(e){e.stop()})),this.video.srcObject=null},groupChange(e){e.detail.value.length>0?this.sure=!0:this.sure=!1,this.updateCheckStatus()},updateCheckStatus(){i("checkP",this.sure)},goCheck(){console.log(this.userInfoT),console.log(this.userInfoT.user_integral>=this.cost),this.userInfoT.user_integral>=this.cost?r({url:"/pages/health/healthRunning"}):this.showEnouth=!0},checkHandler(){this.sure?this.goCheck():u({content:"未勾选同意，是否确定自动勾选?",showCancel:!0,success:e=>{console.log(e),e.confirm&&(this.sure=!0,this.updateCheckStatus(),this.goCheck())}})},nextPupImage(){this.pupIndex<this.pupimage.length-1?this.pupIndex++:(this.puposhow=!1,this.gift())},skipPup(){this.puposhow=!1,this.gift()}}},[["render",function(e,s,t,o,a,n){const i=C,l=p,c=E(d("tabbar"),I),r=B,u=b,T=x;return f(),h(l,{class:"container"},{default:g((()=>[1==a.puposhow?(f(),h(l,{key:0,class:"pup-mask"},{default:g((()=>[m(i,{src:a.pupimage[a.pupIndex].image,class:"pup-img",onClick:n.nextPupImage,mode:"widthFix"},null,8,["src","onClick"]),m(l,{class:"pup-skip-btn",onClick:A(n.skipPup,["stop"])},{default:g((()=>[k(w(a.pupIndex===a.pupimage.length-1?"完成":"跳过"),1)])),_:1},8,["onClick"])])),_:1})):v("",!0),0==a.puposhow?(f(),h(l,{key:1},{default:g((()=>[m(c,{current:"0"}),m(l,{class:"main"},{default:g((()=>[m(l,{class:"kv",ref:"cccc"},{default:g((()=>[m(i,{class:"kv-img",src:"/sleeph5/assets/JK_02_Bg01_cy-DWkpfUgs.png",mode:"widthFix"})])),_:1},512)])),_:1}),m(l,{class:"opt-part"},{default:g((()=>[m(l,{class:"opt1 flex just-align-center"},{default:g((()=>[m(l,{class:"opt",onClick:n.checkHandler},{default:g((()=>[m(r,null,{default:g((()=>[k("开始测量")])),_:1}),m(l,{class:"flex align-items",style:{}},{default:g((()=>[m(i,{mode:"widthFix",class:"icon",src:"data:image/png;base64,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"}),m(r,{class:"cost-c"},{default:g((()=>[k(w(a.config.detection_deduct)+"积分/次",1)])),_:1})])),_:1})])),_:1},8,["onClick"])])),_:1}),m(l,{class:"law flex just-align-center align-center"},{default:g((()=>[m(T,{ref:"ggg",onChange:n.groupChange},{default:g((()=>[m(l,{class:"flex just-align-center align-center"},{default:g((()=>[m(u,{class:"",style:{transform:"scale(0.9)"},activeBackgroundColor:"#F77913",iconColor:"#ffffff",checked:a.sure,value:"sure"},null,8,["checked"]),m(r,null,{default:g((()=>[k("我已经阅读同意")])),_:1})])),_:1})])),_:1},8,["onChange"]),m(r,{class:"line",onClick:n.navLink},{default:g((()=>[k("用户使用条款")])),_:1},8,["onClick"])])),_:1}),m(l,{class:"my-score flex just-align-center align-center"},{default:g((()=>[m(l,{class:"my-left flex align-center"},{default:g((()=>[m(l,{class:"flex align-items"},{default:g((()=>[k("我的积分"),m(i,{mode:"widthFix",class:"icon1",src:F})])),_:1}),m(l,{class:"score"},{default:g((()=>[k(w(a.userInfoT.user_integral?a.userInfoT.user_integral:0),1)])),_:1})])),_:1}),m(l,{class:"score-more",onClick:n.navMoreLink},{default:g((()=>[k("获取积分")])),_:1},8,["onClick"])])),_:1}),m(l,{class:"tips",style:{"text-align":"left","font-weight":"bold","font-size":"12px","padding-bottom":"60px"}},{default:g((()=>[k(" 人脸拍摄仅用于您的健康检测，我们将对您的隐私信息采取严格保密措施。为保障检测效果并保护您的隐私，请您在拍照时注意：在光线良好的私密环境下独立完成面部拍摄。 ")])),_:1})])),_:1}),a.showFirstBlood?(f(),h(l,{key:0,class:"firs-blood up-icon-effect"},{default:g((()=>[m(l,{class:"not-enough-mask",onClick:n.hideFirstBlood},null,8,["onClick"]),m(l,{class:"first-blood-back"}),m(l,{class:"not-button",onClick:n.hideFirstBlood},{default:g((()=>[k("关注公众号并领取")])),_:1},8,["onClick"])])),_:1})):v("",!0),a.showEnouth?(f(),h(l,{key:1,class:"not-enough up-icon-effect"},{default:g((()=>[m(l,{class:"not-enough-mask",onClick:n.hideEnouth},null,8,["onClick"]),m(l,{class:"not-enough-back"}),m(l,{class:"not-button",style:{"margin-top":"70rpx"},onClick:n.navMoreLink},{default:g((()=>[k("获得积分")])),_:1},8,["onClick"])])),_:1})):v("",!0)])),_:1})):v("",!0)])),_:1})}],["__scopeId","data-v-491026ee"]]);export{_ as default};
