import{u as t,s as e,a as s,a9 as a,n as i,A as n,aa as o,c as r,ab as d,i as h,w as l,j as c,o as g,k as u,l as m,t as p,I as v,a2 as f,q as x,T as y}from"./index-BNfv6lMe.js";import{i as w}from"./index.BdQ0JTuP.js";import{x as L}from"./index.D-NzfIhQ.js";import{_ as T}from"./_plugin-vue_export-helper.BCo6x5W8.js";const k=T({setup(){const s=t(),{userInfo:a,measureToken:i}=e(s);return console.log("health setup:::",s),{userInfo:a,getUserInfo:s}},data(){return{config:{},text1:"",text2:"",text3:"",finished:!1,gaugeData:[{value:0,name:"",title:{offsetCenter:["0%","-30%"]},detail:{valueAnimation:!0,offsetCenter:["0%","0%"]}}],totalOption:{animation:!0,animationEasing:"linear",animationDuration:function(t){return 100*t},animationDurationUpdate:0,series:[{type:"gauge",startAngle:90,endAngle:-270,pointer:{show:!1},progress:{show:!0,overlap:!1,roundCap:!0,clip:!1,itemStyle:{color:"#ffaa00",borderWidth:0,borderColor:"#f2b329"}},axisLine:{lineStyle:{width:10}},splitLine:{show:!1,distance:0,length:10},axisTick:{show:!1},axisLabel:{show:!1,distance:50},data:this.gaugeData,title:{fontSize:14},detail:{width:50,height:14,fontSize:14,color:"#ffaa00",borderColor:"#ffaa00",borderRadius:20,borderWidth:1,formatter:"{value}%"}}]},measureIns:"",video:null,collectTime:20,canvas:null,equeneId:0,intervalId:0,counting:3,LastTimestamp:0,echartIns:{},message:"",MaxMeasureTime:90,StartMeasurementTime:0,backBtnStyle:{"--canvasWdith":"30px","--canvasHeight":"30px","--canvasLeft":"30px","--canvasTop":"30px"},SSS:""}},computed:{},onShow(){this.startCamera(),this.confgn(),this.message="",this.counting=3,this.finished=!1},onHide(){this.stopMedia()},methods:{confgn(){s({}).then((t=>{this.config=t}))},deduct(){a({}).then((t=>{i({url:"/pages/health/healthResult"})}))},initCharts(){this.$nextTick((()=>{this.echartIns=w(this.$refs.charts1),this.totalOption.series[0].data=this.gaugeData,this.echartIns.setOption(this.totalOption)}))},addListener(){const e=t();e.measureToken||n({title:"不存在token"}),this.text1=e.measureToken;const s=new L.Measurement(e.measureToken,L.MeasurementCategory.ALL);this.text2=L.MeasurementCategory.ALL,this.text3=s;let a=this;s.addEventListener("started",((t,e)=>{console.log("measurementId:",e);let i=a.canvas;console.log("measurementId canvas:",i),i&&i.width?requestAnimationFrame((t=>{a.LastTimestamp=t,a.equenId(s,t)})):n({title:"canvas width error"})})),s.addEventListener("crashed",(async(t,e)=>{this.message=e,console.log("crashed!停止采集视频"),a.stopMedia(),n({title:"意外停止采集视频，请重试"})})),s.addEventListener("collected",(t=>{console.log("正常停止采集视频")})),s.addEventListener("chunkReportGenerated",((t,e)=>{console.log("chunkReportGenerated",e)})),s.addEventListener("wholeReportGenerated",((t,e)=>{a.finished||(console.log("wholeReportGenerated",e),e.aggressivityreport&&(e.aggressivityreport.explanation.detailsList[0].valuesList[0]="进取性（也可称为进取精神、上进心）是指个体在追求目标、实现自我价值的过程中，所表现出的积极向上、勇于挑战、不断超越自我的内在动力和态度。它是一种内在的心理品质，体现为对个人成长、事业发展和社会贡献的强烈渴望，并伴随为此付出努力的意愿和行动。在自制力不足的情形下，进取性会表现为生活上的攻击性.",e.aggressivityreport.data>=0&&e.aggressivityreport.data<=20?(e.aggressivityreport.explanation.introductionList[0]="您的进取性处于较低水平，对目标缺乏主动追求的意识，自我价值实现的内在动力较弱，行动力不足。在面对挑战时，往往倾向于回避，较少主动尝试突破现状，这可能会在一定程度上限制个人成长和发展的可能性。",e.aggressivityreport.explanation.advicesList[0].valuesList[0]="建议从身边的小事入手，逐步唤醒进取意识。例如，每天为自己设定一个极易完成的小目标，如整理桌面、听一首新歌曲，并在完成后给予自己积极的心理暗示；尝试参与一些简单的社交活动，和身边积极向上的人交流，从他们身上汲取动力；在生活中培养一个低成本的小爱好，如养一盆绿植，观察其生长变化，从中感受付出与收获的联系，逐步激发行动的意愿。"):e.aggressivityreport.data>=21&&e.aggressivityreport.data<=40?(e.aggressivityreport.explanation.introductionList[0]="您有一定的进取意识，偶尔会对某些目标产生追求的想法，但这种动力不够稳定，容易受到外界因素的干扰而中断。在面对稍具难度的任务时，容易产生畏难情绪，缺乏持续行动的毅力，自我超越的意愿不够强烈。",e.aggressivityreport.explanation.advicesList[0].valuesList[0]="建议建立简单的目标追踪机制，比如用表格记录每天为目标付出的行动，直观看到自己的努力轨迹，增强坚持下去的信心；学习一些基础的时间管理方法，合理安排做事的顺序，避免因任务繁杂而产生抵触心理；每周给自己安排一次 “小挑战”，比如尝试做一道新菜、走一条新的上班路线，在完成挑战的过程中积累成就感，强化进取的动力。"):e.aggressivityreport.data>=41&&e.aggressivityreport.data<=60?(e.aggressivityreport.explanation.introductionList[0]="您的进取性处于中等水平，有较为明确的目标追求，并且能够主动为实现目标付出行动。但在面对复杂或长期的目标时，可能会因为缺乏清晰的规划而感到迷茫，偶尔也会因为短期内看不到成果而产生动摇，进取的持续性有待提升。",e.aggressivityreport.explanation.advicesList[0].valuesList[0]="建议将较大的目标分解成多个具体的小步骤，明确每个步骤的完成时间和衡量标准，让目标变得更易执行；定期对自己的行动进行复盘，总结成功的经验和失败的教训，及时调整前进的方向和方法；注意保持身心的平衡，合理安排休息和娱乐时间，避免因过度消耗精力而降低进取的热情。"):e.aggressivityreport.data>=61&&e.aggressivityreport.data<=80?(e.aggressivityreport.explanation.introductionList[0]="您的进取性处于中等偏上水平，表现出较强的目标感和行动力，能够积极应对挑战，在实现目标的过程中展现出一定的毅力和决心。但在面对困难和挫折时，可能会因为过于专注于结果而忽略过程中的收获，有时还会因为对自己要求过高而产生不必要的压力。",e.aggressivityreport.explanation.advicesList[0].valuesList[0]="建议在追求目标的过程中，学会关注过程中的进步，即使最终结果未达预期，也能肯定自己在过程中的努力；适当调整对自己的要求，允许自己有犯错和休息的空间，避免因过度紧绷而影响状态；尝试与他人分享自己的目标和进展，一方面可以获得他人的支持和建议，另一方面也能通过交流拓宽思路，找到更高效的实现路径。"):e.aggressivityreport.data>=81&&e.aggressivityreport.data<=100&&(e.aggressivityreport.explanation.introductionList[0]="您的进取性非常突出，拥有强烈的自我驱动能力和坚定的目标信念，能够为了实现目标付出巨大的努力，甚至在面对重大困难时也能保持积极的态度。但需要注意的是，过度专注于目标可能会让你忽略生活的其他方面，如家庭关系、身心健康等，长期下来可能会导致身心失衡。",e.aggressivityreport.explanation.advicesList[0].valuesList[0]="建议在追求事业或个人成长目标的同时，合理分配时间和精力到家庭和生活中。养成定期体检和运动的习惯，保证身体处于健康状态，为持续进取提供基础；学会适当放慢脚步，偶尔给自己一段放松的时间，让身心得到休整，以更饱满的状态面对后续的挑战。")),o({result:e}).then((t=>{console.log("add:",t),r("test_id",t.id),a.stopMedia(),a.deduct()})),a.finished=!0)})),console.log("measurement:",s),setTimeout((()=>{this.takePhoto()}),100),setTimeout((()=>{this.counting=2}),1e3),setTimeout((()=>{this.counting=1}),2e3),setTimeout((()=>{this.counting=0,this.StartMeasurementTime=Date.now(),s.start(this.canvas),this.initCharts()}),3e3)},equenId(t,e){if(e-this.LastTimestamp>=40){this.MeasureTime=Math.floor((Date.now()-this.StartMeasurementTime)/1e3),(Date.now()-this.StartMeasurementTime)/1e3<=this.collectTime&&(this.message="正在测量..."),(Date.now()-this.StartMeasurementTime)/1e3>=this.collectTime&&(this.message="汇总中..."),this.LastTimestamp=e;let s=((Date.now()-this.StartMeasurementTime)/(1e3*this.collectTime)*100).toFixed(2);this.gaugeData[0].value=s>100?100:s,this.echartIns.setOption({series:[{data:this.gaugeData,pointer:{show:!1}}]}),t.enqueue({frame:this.canvas,timestamp:Date.now()})}this.MeasureTime>=this.MaxMeasureTime?(this.stopMedia(),this.message="网络请求异常，请稍后重试",n({title:this.message}),i({url:"/pages/health/health"})):this.equeneId=requestAnimationFrame((e=>{this.equenId(t,e)}))},takePhoto(t){let e=document.getElementsByClassName("uni-canvas-canvas");if(document.getElementsByClassName("uni-canvas"),this.canvas=e[0],!this.canvas)return void n({title:"没有canvas!"});const s=this.canvas.getContext("2d");let a=d();const i={width:a.screenWidth,height:a.screenHeight};return this.canvas.width=i.width,this.canvas.height=i.width,this.$set(this.backBtnStyle,"--canvasWidth",i.width+"px"),this.$set(this.backBtnStyle,"--canvasHeight",i.width+"px"),this.$set(this.backBtnStyle,"--canvasLeft","0px"),this.$set(this.backBtnStyle,"--canvasTop","110rpx"),s.scale(-1,1),s.translate(-i.width/a.pixelRatio,0),s.drawImage(this.video,0,0,i.width,i.width,0,0,i.width/a.pixelRatio,i.width/a.pixelRatio),this.intervalId=requestAnimationFrame((t=>{this.takePhoto(t)})),""},stopMedia(){try{const t=this.video.srcObject;t.getTracks().forEach((function(t){t.stop()})),this.video.srcObject=null,cancelAnimationFrame(this.equeneId),cancelAnimationFrame(this.intervalId)}catch(t){}},async startCamera(){let t=d();const e={width:t.screenWidth,height:t.screenHeight},s={audio:!1,video:{width:{ideal:t.screenWidth,min:t.screenWidth,max:1920},height:{ideal:t.screenWidth,min:t.screenWidth,max:1080},frameRate:{ideal:30,max:30},facingMode:{ideal:"user"}}};console.log("startCamera",t),this.video=document.getElementById("video"),this.video.width=e.width,this.video.height=e.height,this.video.srcObject=await window.navigator.mediaDevices.getUserMedia(s),this.video.play(),this.LastTimestamp=0,this.addListener(),console.log("startCamera success")}}},[["render",function(t,e,s,a,i,n){const o=x,r=c,d=y;return g(),h(r,{class:"container"},{default:l((()=>[u(o,{class:"topii",src:"/sleeph5/assets/20240515112204-C9wPTcmJ.png",mode:""}),u(r,{class:"user-tip"},{default:l((()=>[u(o,{class:"imgmask",src:"/sleeph5/assets/JK_03_Mask00-DwvlbVqn.png",mode:"widthFix"}),u(r,{class:"message"},{default:l((()=>[m(p(i.message),1)])),_:1}),u(r,{class:"tips2"},{default:l((()=>[m("请将您的身体置于虚线内")])),_:1}),u(r,{class:"tips2"},{default:l((()=>[m("检测大约需要30s，请在良好的光线环境内使用")])),_:1}),u(r,{class:"tips2"},{default:l((()=>[m("请注意:本产品暂不适合未成年人的检测。")])),_:1}),u(r,{class:"tips2"},{default:l((()=>[m("测量数据与结果仅为身体指征参考信息。是为了助力您更好地了解自身健康，不能作为诊疗依据。建议您定期前往专业体检机构进行深度健康体检，呵护自己与家人。")])),_:1}),u(r,{class:"tips2"},{default:l((()=>[m("备注")])),_:1}),u(r,{class:"tips2"},{default:l((()=>[m("睡商检测共分为两项检测，完成第一项AI健康检测后进行第二项检测，第二项检测需用户自行点击按钮进行问卷调查，填写完成后会自动生成睡商")])),_:1}),u(r,{class:"tips2"},{default:l((()=>[m("检测所使用的"+p(i.config.detection_deduct)+"积分将再完成AI健康检测后扣除，若途中退出则积分不退不补",1)])),_:1})])),_:1}),u(d,{id:"canvas",class:"canvas-c",style:v(i.backBtnStyle),"canvas-id":"canvas"},null,8,["style"]),i.counting>0?(g(),h(r,{key:0,class:"counting-c"},{default:l((()=>[m(p(i.counting),1)])),_:1})):(g(),f("div",{key:1,class:"circle",ref:"charts1"},null,512))])),_:1})}],["__scopeId","data-v-463bd42d"]]);export{k as default};
