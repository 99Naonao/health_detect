import{g as t,E as e,z as s,F as o,c as a,G as i,n,B as l,A as c,H as r,i as d,w as p,j as u,o as h,k as g,l as x,t as m,C as _,p as f,K as b,L as w,M as y,r as k,v}from"./index-CRXElb8Q.js";import{i as C}from"./index.QLh0gCRz.js";import{_ as D}from"./_plugin-vue_export-helper.BCo6x5W8.js";const F=D({data:()=>({loading:!0,recommendedProducts:[{name:"【翼合枕】",description:"护颈助眠 90D慢回弹记忆棉",image:"/static/images/product1.jpg"},{name:"【翼合枕】",description:"护颈助眠 90D慢回弹记忆棉",image:"/static/images/product1.jpg"},{name:"【翼合枕】",description:"护颈助眠 90D慢回弹记忆棉",image:"/static/images/product1.jpg"},{name:"【翼合枕】",description:"护颈助眠 90D慢回弹记忆棉",image:"/static/images/product1.jpg"}],gaugeData:[{value:60,name:"score",title:{offsetCenter:["00%","30%"]},detail:{valueAnimation:!0,offsetCenter:["0%","00%"]}}],totalOption:{series:[{type:"gauge",startAngle:0,endAngle:-360,pointer:{show:!1},progress:{show:!0,overlap:!1,roundCap:!0,clip:!1,itemStyle:{color:"#ffaa00",borderWidth:1,borderColor:"#ffaa00"}},axisLine:{lineStyle:{width:10}},splitLine:{show:!1,distance:0,length:10},axisTick:{show:!0},axisLabel:{show:!1,distance:50},data:{},title:{fontSize:14},detail:{width:50,height:14,fontSize:34,color:"inherit",borderColor:"inherit",borderRadius:20,borderWidth:0,formatter:"{value}"}}]},conclusion:"",numb:"",conclusionText:"",numtolt:"",data__:{},fang:0,conclusionid:"",explain_guide:"",title:"",showIntro:!1,userScaleConclusionDto:{id:"",deepseek_conclusion:""}}),onLoad(t){this.numb=Number(100-5*t.numtolt),this.numtolt=t.numtolt,this.conclusionid=t.conclusionid,this.Detectionsection()},onShow(){this.resultLists()},mounted(){this.$nextTick((()=>{var t=C(this.$refs.charts1);this.totalOption.series[0].data=this.gaugeData,this.gaugeData[0].value=this.numb,t.setOption(this.totalOption)}))},methods:{StorageSync(){this.conclusionText=t("conclusion_Text")},resultLists(){e({page_no:1,page_size:1}).then((t=>{console.log("res.res:res",t),this.text2=t,t.lists[0].result,this.data__=t.lists[0].result,this.deepseekchat(t.lists[0].result)}))},Detectionsection(){s({score:this.numtolt}).then((t=>{this.recommendedProducts=t.goods_lists,this.conclusion=t.detail.remarks,this.title=t.detail.title,this.explain_guide=t.detail.explain_guide,console.log("res.999",t)}))},deepseekchat(t){console.log("report:report",t);let e="";e=0==t.afreport.data?"未发生":"已发生",console.log("hrvtext:hrvtext",e);const s=(100*t.riskreport.data.bpheartattack).toFixed(2),n=(100*t.riskreport.data.bpstroke).toFixed(2),l=(100*t.riskreport.data.bpcvd).toFixed(2),c=t.riskreport.data.bppp.toFixed(2),r=t.riskreport.data.bptau.toFixed(2),d=t.aggressivityreport.data.toFixed(2),p=t.anxietyreport.data.toFixed(2),u=t.vitalityreport.data.toFixed(2),h=t.suppressionreport.data.toFixed(2),g=t.fatiguereport.data.toFixed(2),x=t.msireport.data.toFixed(2);console.log("bpheartattack:bpheartattack",s);const m="(结论包括综合心健康风险(分值越低风险越高，100分制)"+t.physiologyscorereport+"皮肤年龄"+t.essentialreport.data.age+"BMI"+t.essentialreport.data.bmi+"心率"+t.hrreport.data.hrbpm+"心率变异性"+t.hrreport.data.hrv+"房颤"+e+"舒张压"+t.bpreport.data.bpdiastolic+"收缩压"+t.bpreport.data.bpsystolic+"血氧饱和度"+t.spo2hreport.data+"心脏病风险"+s+"中风风险"+n+"心血管风险"+l+"心脏压力"+c+"血管功能"+r+"情绪综合分(分值越低情绪越差，100分制)"+t.emotionscorereport+"进取性"+d+"焦虑度"+p+"活力度"+u+"抑郁度"+h+"疲劳度"+g+"压力度"+x+")";console.log("reportText:88",m);const _="你是一位专业且敏锐的睡眠健康顾问，凭借深厚的专业知识与精准的分析能力，深度、全面地综合分析已有健康检测结论("+m+")和匹兹堡睡眠质量问卷结论("+this.conclusion+")。其中睡商评分着重依据匹兹堡睡眠质量问卷结论，健康检测辅助评分。给出简洁直观、类似 MBTI 性格的小标题。";console.log("messagetext:88",_),o({message:_}).then((t=>{console.log("res.999",t),console.log("res.this.conclusionid",this.conclusionid),this.conclusionText=t,a("conclusion_Text",this.conclusionText),this.userScaleConclusionDto.id=this.conclusionid,this.userScaleConclusionDto.deepseek_conclusion=this.conclusionText,""!=this.conclusionText&&i({userScaleConclusionDto:this.userScaleConclusionDto}).then((t=>{})),this.loading=!1}))},async initLastData(t){let e=t.contentDetail,s=await getJsonResult(e);this.data__=s,this.deepseekchat(s)},handleShare(){n({url:"/pages/invite_poster/invite_poster?numtolt="+this.numb+"&shuishan="+this.numtolt})},handleRetest(){l({url:"/pages/health/health"})},jumpHandler(e){const s=t("invite_code");window.wx?window.wx.launchMiniProgram({appId:"wx041bde7c633d4ec0",path:"/pages/goods_detail/goods_detail?scene=invite_code%3D"+s+"%26id%3D"+e,success:function(t){console.log("跳转成功",t)},fail:function(t){console.log("跳转失败",t),c({title:"跳转失败，请稍后重试",icon:"none"})}}):c({title:"请在微信中打开",icon:"none"})},goShop(){c({title:"跳转商城开发中",icon:"none"})},showFullConclusion(){this.showIntro=!0},getInviteCode:()=>t("invite_code")||"",handleLaunch(t){console.log("跳转成功",t)},handleError(t){console.log("跳转失败",t),c({title:"跳转失败，请稍后重试",icon:"none"})}}},[["render",function(t,e,s,o,a,i){const n=u,l=v,c=r("wx-open-launch-weapp");return h(),d(n,{class:"conclusion-container"},{default:p((()=>[g(n,{class:"score-section"},{default:p((()=>[g(n,{class:"title"},{default:p((()=>[x(m(a.title),1)])),_:1}),g(n,{class:"",style:{"text-align":"center","font-size":"14px",color:"#000","margin-top":"5px",padding:"0 15px"}},{default:p((()=>[x(m(a.explain_guide),1)])),_:1}),g(n,{class:"score-wrapper"},{default:p((()=>[_("div",{ref:"charts1",style:{width:"168px",height:"168px"}},null,512)])),_:1}),g(n,{class:"btn-row"},{default:p((()=>[g(n,{class:"main-btn",style:{"background-color":"#F77913"},onClick:i.handleShare},{default:p((()=>[x("分享海报")])),_:1},8,["onClick"]),g(n,{class:"main-btn",style:{"background-color":"#153b70"},onClick:i.handleRetest},{default:p((()=>[x("再测一次")])),_:1},8,["onClick"])])),_:1})])),_:1}),g(n,{class:"conclusion-section"},{default:p((()=>[g(l,{class:"section-title"},{default:p((()=>[x("报告结论")])),_:1}),a.loading?(h(),d(n,{key:0,class:"loading-wrapper"},{default:p((()=>[g(n,{class:"loading-spinner"}),g(l,{class:"loading-text"},{default:p((()=>[x("正在生成报告...")])),_:1})])),_:1})):(h(),d(n,{key:1},{default:p((()=>[g(n,{class:"conclusion-text",style:{"line-height":"1.8"}},{default:p((()=>[x(m(a.conclusionText),1)])),_:1}),g(n,{class:"more-btn",onClick:i.showFullConclusion},{default:p((()=>[x("查看更多")])),_:1},8,["onClick"])])),_:1}))])),_:1}),a.showIntro?(h(),d(n,{key:0,class:"intro-modal"},{default:p((()=>[g(n,{class:"intro-content"},{default:p((()=>[g(n,{class:"intro-title"},{default:p((()=>[x("详细报告")])),_:1}),g(n,{class:"intro-text"},{default:p((()=>[g(n,{style:{"text-align":"left",color:"#333"}},{default:p((()=>[x(m(a.conclusionText),1)])),_:1})])),_:1}),g(n,{class:"intro-btn",onClick:e[0]||(e[0]=t=>a.showIntro=!1)},{default:p((()=>[x("关闭")])),_:1})])),_:1})])),_:1})):f("",!0),g(n,{class:"products-section"},{default:p((()=>[g(l,{class:"section-title"},{default:p((()=>[x("推荐产品")])),_:1}),g(n,{class:"product-list"},{default:p((()=>[(h(!0),b(y,null,w(a.recommendedProducts,((t,e)=>(h(),d(n,{class:"product-item",key:e},{default:p((()=>[g(c,{id:"launch-btn",class:"conclusion-img",style:{},appid:"wx041bde7c633d4ec0",username:"gh_e511f8f79ddd",path:"/pages/goods_detail/goods_detail?scene=invite_code%3D"+i.getInviteCode()+"%26id%3D"+t.id},{default:p((()=>[(h(),d(k("script"),{type:"text/wxtag-template"},{default:p((()=>[_("img",{style:{width:"290rpx",height:"300rpx","margin-right":"10rpx"},src:t.image},null,8,["src"])])),_:2},1024))])),_:2},1032,["path"]),g(c,{id:"launch-btn",class:"conclusion-textTT",style:{width:"150px",height:"90px"},appid:"wx041bde7c633d4ec0",username:"gh_e511f8f79ddd",path:"/pages/goods_detail/goods_detail?scene=invite_code%3D"+i.getInviteCode()+"%26id%3D"+t.id},{default:p((()=>[(h(),d(k("script"),{type:"text/wxtag-template"},{default:p((()=>[g(n,{class:"product-info"},{default:p((()=>[g(l,{class:"product-name",style:{"font-size":"12px"}},{default:p((()=>[x(m(t.name),1)])),_:2},1024)])),_:2},1024)])),_:2},1024))])),_:2},1032,["path"])])),_:2},1024)))),128))])),_:1})])),_:1}),g(n,{class:"footer-btn-wrapper bottom-part flex align-items"},{default:p((()=>[g(c,{id:"launch-btn",style:{width:"100%"},appid:"wx041bde7c633d4ec0",username:"gh_e511f8f79ddd"},{default:p((()=>[(h(),d(k("script"),{type:"text/wxtag-template"},{default:p((()=>[g(n,{class:"jump",style:{color:"white","background-color":"#F77913",padding:"10rpx 20rpx","font-size":"32rpx","border-radius":"30rpx","justify-content":"center",display:"flex",width:"485rpx",height:"60rpx",margin:"0 auto","text-align":"center"}},{default:p((()=>[_("img",{style:{width:"68rpx",height:"68rpx","margin-right":"10rpx","margin-top":"-5rpx"},src:"https://sleep.zsyl.cc/sleeph5/assets/JK_08_butSCIcon-BFn7SZmL.png"}),g(l,{class:"txt",style:{"line-height":"60rpx"}},{default:p((()=>[x("眠加商城")])),_:1})])),_:1})])),_:1}))])),_:1})])),_:1})])),_:1})}],["__scopeId","data-v-e9aeb530"]]);export{F as default};
